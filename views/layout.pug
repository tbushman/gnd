doctype html
html
	head
		title= appTitle
		meta(name="viewport", content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no")
		//link(rel="stylesheet", href="/stylesheets/jquery-ui.min.css")
		//link(rel="stylesheet", href="/stylesheets/leaflet.css")
		link(rel="stylesheet", href="/stylesheets/default.css", type="text/css")
		//link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/css/materialize.min.css")
		link(href="https://fonts.googleapis.com/css?family=Roboto", rel="stylesheet")
		
		script(type="text/javascript", src="/scripts/jquery.min.js")
		//script(type="text/javascript", src="/scripts/jquery-ui.min.js")
		//script(type="text/javascript", src="/scripts/leaflet.js")
		script(type="text/javascript", src="/scripts/marked.min.js")
		//script(src="https://use.fontawesome.com/b9a4978394.js")
		script(type="text/javascript", src="/scripts/d3.v3.min.js")
		//script(src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/js/materialize.min.js")
		//script(src="https://unpkg.com/vue/dist/vue.js")
		//https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/forms/alerts
	body
		block page
			- var theStore = theStore
			script(type="application/json").
				function uiBlogMode(){
					$('div.menu.draw').removeClass('draw');
					$('div.menu').addClass('blog');
					$('.grid-container').removeClass('draw');
					$('.grid-container').addClass('blog');
					$('.grid-container').addClass('selected');
					$('#select').removeClass('draw');
					$('#select').addClass('blog');
				}
				function uiDrawMode(){
					$('div.menu.blog').removeClass('blog');
					$('div.menu').addClass('draw');
					$('.grid-container').removeClass('blog');
					$('.grid-container').addClass('draw');
					$('.grid-container').removeClass('selected');
					$('#select').removeClass('blog');
					$('#select').addClass('draw');
				}
		block header

		block content
			

		a#publish_logo(href="https://github.com/tbushman/sfusd" target="_blank")
			img(src="/images/sfusdblish_logo.svg")
		
		script(type="application/javascript").
			$(document).ready(function(){
				$('.dropdown').not('.mainmenu').slideUp(100);
				$('.drop').slideUp(100);
				$('.selected').removeClass('selected');
			})
			$(document).on('click', 'canvas', function(e){
				if ($('.menu').hasClass('blog')) {
					//				e.preventDefault();
					//				InitializeApp();
					
					/*$('.dropdown').not('.mainmenu').slideUp(100);
					$('.drop').slideUp(100);
					$('.selected').removeClass('selected');*/
					uiDrawMode()
				}
			});
			//drop-down event listener
			$(document).on('click', '.dropdown', function (e) { 
				//e.preventDefault();
				console.log(e.target)
				var that, main;
				if ($(this).hasClass('mainmenu')) {
					that = $('#tlmodules.dropdown');
					main = true;
				} else {
					that = this;
					main = false;
				}
				if ($(that).hasClass('selected')) {
					if (main && $('div.menu').hasClass('blog')) {
						$(that).slideUp(100);
						$(that).removeClass("selected");
					} else {
						if ($('div.menu').hasClass('blog')) {
							$(that).next('.drop').slideUp(100);
						}
					}
				} else {
					if (main && $('div.menu').hasClass('blog')) {
						$(that).slideDown(200);
						$(that).addClass('selected');
					} else {
						$(that).next('.drop').slideDown(200);
					}
				}
				if ($('div.menu').hasClass('draw')) {
					
					uiBlogMode()
				} else {
					if ($('div.menu').hasClass('blog')) {
						uiBlogMode()
					}
				}
				//e.stopPropagation();
			});
			function removeOldAlert()
				{
					var oldAlert = document.getElementById("alert");
					if (oldAlert)
						document.body.removeChild(oldAlert);
				}
				
				function addAlert(aMsg)
				{
					removeOldAlert();
					var newAlert = document.createElement("div");
					newAlert.setAttribute("role", "alert");
					newAlert.setAttribute("id", "alert");
					var msg = document.createTextNode(aMsg);
					newAlert.appendChild(msg);
					document.body.appendChild(newAlert);
				}
				function checkNameValidity(aID, aSearchTerm, aMsg)
				{
					var elem = document.getElementById(aID);
					for (var i = 0; i < elem.value.length; i++) {
						if (aSearchTerm.indexOf(elem.value.charAt(i)) !== -1) {
							elem.setAttribute("aria-invalid", "true");
							addAlert(aMsg);
						} else {
							elem.setAttribute("aria-invalid", "false");
							removeOldAlert();
						}
					}
				}
				function checkEmailValidity(aID, aSearchTerm, aMsg)
				{
					var elem = document.getElementById(aID);
					console.log(aSearchTerm)
					if (elem.value.indexOf(aSearchTerm) === -1) {
						elem.setAttribute("aria-invalid", "true");
						addAlert(aMsg);
					} else {
						elem.setAttribute("aria-invalid", "false");
						removeOldAlert();
					}
				}

			
		
		
		
		
